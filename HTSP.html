<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTSP</title>
    <style>
        * {
            margin: 0px;
            padding: 0px;
            box-sizing: border-box;
        }
        
        html {
            background-repeat: no-repeat;
            background-position: center;
            background-attachment: fixed;
            overflow: hidden;
            transition: 0.5s;
        }
        
        .ksss,
        .qjss,
        .jr {
            color: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(3px);
            background-color: rgba(0, 0, 0, 0.3);
        }
        
        .ksss {
            position: fixed;
            top: calc((50% - 25px) - 100px);
            left: calc(50% - 75px);
            width: 150px;
            height: 50px;
            text-align: center;
            line-height: 48px;
            border-radius: 10px;
        }
        
        .qjss {
            position: fixed;
            top: calc(50% - 25px);
            left: calc(50% - 75px);
            width: 150px;
            height: 50px;
            text-align: center;
            line-height: 48px;
            border-radius: 10px;
        }
        
        .jr {
            position: fixed;
            top: calc((50% - 25px) + 100px);
            left: calc(50% - 75px);
            width: 150px;
            height: 50px;
            text-align: center;
            line-height: 48px;
            border-radius: 10px;
        }
        
        .tsk {
            position: fixed;
            top: 0;
            font: 0;
            width: 100%;
            text-align: center;
            font-size: 12px;
            color: white;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .txk {
            position: fixed;
            bottom: 0;
            font: 0;
            width: 100%;
            text-align: center;
            font-size: 12px;
            color: white;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .jdt {
            position: fixed;
            top: 20px;
            left: 0;
            width: 90%;
            height: 16px;
            margin: 0px 5%;
            padding: 3px;
            border: 1px solid rgb(255, 255, 255);
        }
        
        .jdt2 {
            float: left;
            width: 0%;
            height: 100%;
            background-color: white;
            transition: 0.5s linear;
        }
        
        .Sku_tcjg_Max {
            position: fixed;
            padding: 0 50px 0 50px;
            width: auto;
            height: 30px;
            top: 0px;
            text-align: center;
            border-radius: 5px;
            line-height: 30px;
            transition: 0.5s;
            z-index: 1;
            opacity: 0;
            animation: Sku_tcjg_dh 2.5s linear;
        }
        
        @keyframes Sku_tcjg_dh {
            0% {
                /* 动画开始的画面; */
                top: 100px;
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            85% {
                top: 100px;
                opacity: 1;
            }
            100% {
                /* 动画结束的画面; */
                top: 0px;
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <div class="tsk"></div>
    <div class="txk">手机无广告设置: 打开浏览器设置-UA标识 Android 改为 电脑版win<br></div>
    <div class="ksss">本地快速搜索</div>
    <div class="qjss">全局搜索</div>
    <div class="jdt" style="display: none;">
        <div class="jdt2"></div>
    </div>
    <div class="jr" style="display: none;">进入</div>
    <div class="div_img_s" style="display: none;"></div>
    <img class="WGS_HTSP" src="" alt="" style="display: none;">
    <div class="sstp" style="display: none;"></div>

    <!-- 提示音 -->
    <audio class="sku_tsy" src="https://pic.ibaotu.com/00/25/22/14B888piCpnZ.mp3"></audio>
    <audio class="sku_tsy" src="https://img.tukuppt.com/newpreview_music/09/04/07/5c8b02776d58965550.mp3"></audio>

    <script>
        // 弹窗提醒
        function Sku_tctx(zdysx1) {
            var div = document.createElement('div');
            div.className = "Sku_tcjg_Max";
            div.innerHTML = zdysx1;
            if (localStorage.bei_jing_kuan_ture == 1) {
                div.style.border = '1px solid rgba(255, 255, 255, 0.9)';
                div.style.backgroundColor = 'rgba(0, 0, 0, 0.3)';
            }

            document.body.appendChild(div);

            var Sku_tcjg_Max = document.querySelectorAll('.Sku_tcjg_Max');
            Sku_tcjg_Max[Sku_tcjg_Max.length - 1].style.left = ((window.innerWidth / 2) - (Sku_tcjg_Max[Sku_tcjg_Max.length - 1].offsetWidth / 2)) + 'px';

            setTimeout(function() {
                var Sku_tcjg_Max = document.querySelectorAll('.Sku_tcjg_Max');
                document.body.removeChild(Sku_tcjg_Max[0]);
            }, 2500)
        }


        // 随机数
        function sjs(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }


        // 提示音
        var sku_tsy = document.querySelectorAll('.sku_tsy');

        function Sku_tsy(num) {
            sku_tsy[num].play();
        }

        var ksss = document.querySelector('.ksss');
        var qjss = document.querySelector('.qjss');
        var div_img_s = document.querySelector('.div_img_s');
        var jr = document.querySelector('.jr');
        var tsk = document.querySelector('.tsk');
        var WGS_HTSP = document.querySelector('.WGS_HTSP');
        var jdt = document.querySelector('.jdt');
        var jdt2 = document.querySelector('.jdt2');

        //指定删除
        function sz_zdsc(sz_s, sz_sc_zhi, sz_tj_zhi) {
            if (sz_sc_zhi && sz_s.indexOf(sz_sc_zhi) !== -1 && sz_tj_zhi) {
                sz_s.splice(sz_s.indexOf(sz_sc_zhi), 2, sz_tj_zhi);
            } else if (sz_sc_zhi && sz_s.indexOf(sz_sc_zhi) !== -1) {
                sz_s.splice(sz_s.indexOf(sz_sc_zhi), 1);
            }
        }

        if (localStorage.htsp_lj == undefined) {
            localStorage.htsp_lj = '[]';
        }

        if (JSON.parse(localStorage.htsp_lj).length == 0) {
            ksss.style.display = 'none';
        }

        var di_zhi = '';
        var kskg = 0;

        qjss.addEventListener('click', function(e) {
            e.stopPropagation();
            ksss.style.display = 'none';
            if (kskg == 0) {
                kskg = 1;
                this.innerHTML = '稍等.....';

                var s_sz = ['qq', 'ww', 'ee', 'rr', 'tt', 'yy', 'uu', 'ii', 'oo', 'pp', 'aa', 'ss', 'dd', 'ff', 'gg', 'hh', 'jj', 'kk', 'll', 'zz', 'xx', 'cc', 'vv', 'bb', 'nn', 'mm'];
                var htsp_s_tjgs = 0;
                var htsp_s_tjgs_cg = 0;
                var htsp_s_tjgs_sb = 0;
                var htsp_cgqcfgs = 0;

                setTimeout(function() {
                    for (var i = 0; i < s_sz.length; i++) {
                        for (var u = 0; u < 400; u++) {
                            htsp_s_tjgs++;
                            var wz_shu = u < 10 ? '0' + u : u;
                            var imgs = document.createElement('img');
                            imgs.src = 'https://ht' + wz_shu + s_sz[i] + '.xyz:9527/favicon.ico';
                            imgs.addEventListener('load', function(e) {
                                // 分支加速
                                setTimeout(function() {}, 0);

                                htsp_s_tjgs_cg++;
                                console.log('总共 ' + htsp_s_tjgs + ' 失败 ' + htsp_s_tjgs_sb + ' 成功 ' + htsp_s_tjgs_cg);
                                console.log(this.src);
                                di_zhi = this.src;

                                // 保存
                                var htsp_lj = JSON.parse(localStorage.htsp_lj);
                                if (htsp_lj.indexOf(this.src) !== -1) {
                                    htsp_cgqcfgs++;
                                    sz_zdsc(htsp_lj, this.src);
                                } else {
                                    Sku_tsy(1);
                                }
                                htsp_lj.unshift(this.src);
                                localStorage.htsp_lj = JSON.stringify(htsp_lj);

                                // 进入
                                jr.style.display = 'block';

                                tsk.innerHTML = 'HTSP 成功 ' + htsp_s_tjgs_cg + ' 新增 ' + (htsp_s_tjgs_cg - htsp_cgqcfgs) + ' 本地 ' + htsp_lj.length + ' 搜索中...' + (htsp_s_tjgs_cg + htsp_s_tjgs_sb) + '/' + htsp_s_tjgs + ' (进程 ' + (((htsp_s_tjgs_cg + htsp_s_tjgs_sb) / htsp_s_tjgs) * 100).toFixed(2) + '%)';

                                qjss.innerHTML = '搜索中......';
                                jdt.style.display = 'block';
                                jdt2.style.width = (((htsp_s_tjgs_cg + htsp_s_tjgs_sb) / htsp_s_tjgs) * 100).toFixed(2) + '%';

                                if (htsp_s_tjgs_sb + htsp_s_tjgs_cg == htsp_s_tjgs) {
                                    var htsp_lj = JSON.parse(localStorage.htsp_lj);
                                    tsk.innerHTML = 'HTSP 搜索结束' + ' (检测 ' + htsp_s_tjgs + ' 失败 ' + htsp_s_tjgs_sb + ' 成功 ' + htsp_s_tjgs_cg + ' 重复 ' + htsp_cgqcfgs + ' 新增 ' + (htsp_s_tjgs_cg - htsp_cgqcfgs) + ' 本地 ' + htsp_lj.length + ')';
                                    jdt.style.display = 'none';
                                    qjss.innerHTML = '搜索完成';
                                    div_img_s.innerHTML = '';
                                    Sku_tsy(0);
                                }
                            });
                            imgs.addEventListener('error', function(e) {
                                // 分支加速
                                setTimeout(function() {}, 0);

                                htsp_s_tjgs_sb++;
                                var htsp_lj = JSON.parse(localStorage.htsp_lj);

                                tsk.innerHTML = 'HTSP 成功 ' + htsp_s_tjgs_cg + ' 新增 ' + (htsp_s_tjgs_cg - htsp_cgqcfgs) + ' 本地 ' + htsp_lj.length + ' 搜索中...' + (htsp_s_tjgs_cg + htsp_s_tjgs_sb) + '/' + htsp_s_tjgs + ' (进程 ' + (((htsp_s_tjgs_cg + htsp_s_tjgs_sb) / htsp_s_tjgs) * 100).toFixed(2) + '%)';

                                qjss.innerHTML = '搜索中......';
                                jdt.style.display = 'block';
                                jdt2.style.width = (((htsp_s_tjgs_cg + htsp_s_tjgs_sb) / htsp_s_tjgs) * 100).toFixed(2) + '%';

                                console.log('总共 ' + htsp_s_tjgs + ' 失败 ' + htsp_s_tjgs_sb + ' 成功 ' + htsp_s_tjgs_cg);
                                console.log(this.src);
                                if (htsp_s_tjgs_sb + htsp_s_tjgs_cg == htsp_s_tjgs) {
                                    var htsp_lj = JSON.parse(localStorage.htsp_lj);
                                    tsk.innerHTML = 'HTSP 搜索结束' + ' (检测 ' + htsp_s_tjgs + ' 失败 ' + htsp_s_tjgs_sb + ' 成功 ' + htsp_s_tjgs_cg + ' 重复 ' + htsp_cgqcfgs + ' 新增 ' + (htsp_s_tjgs_cg - htsp_cgqcfgs) + ' 本地 ' + htsp_lj.length + ')';
                                    jdt.style.display = 'none';
                                    qjss.innerHTML = '搜索完成';
                                    div_img_s.innerHTML = '';
                                    Sku_tsy(0);
                                }
                            });
                            div_img_s.appendChild(imgs);
                        }
                    }
                }, 500);
            }
        });

        ksss.addEventListener('click', function(e) {
            e.stopPropagation();
            qjss.style.display = 'none';
            if (kskg == 0) {
                kskg = 1;
                this.innerHTML = '稍等.....';

                var htsp_lj = JSON.parse(localStorage.htsp_lj);
                var htsp_s_gs = 0;
                var b = 0;

                function wzjc(dz, sj) {
                    WGS_HTSP.src = dz;
                    WGS_HTSP.addEventListener('load', function(e) {
                        b = 1;
                        console.log('加载成功:' + this.src);
                        di_zhi = this.src;

                        // 进入
                        jr.style.display = 'block';
                        ksss.innerHTML = '搜索完成';
                        console.log();
                        tsk.innerHTML = 'HTSP 地址:' + dz.substring(0, dz.length - 11) + ' (删除无用 ' + (htsp_s_gs) + ' 本地剩余 ' + (htsp_lj.length - htsp_s_gs) + ')';
                        Sku_tsy(0);
                    });
                    WGS_HTSP.addEventListener('error', function(e) {
                        console.log('加载失败:' + this.src);
                        // 删除
                        var htsp_s2 = JSON.parse(localStorage.htsp_lj);
                        sz_zdsc(htsp_s2, dz);
                        localStorage.htsp_lj = JSON.stringify(htsp_s2);
                    });

                    setTimeout(function() {
                        if (b !== 1) {
                            console.log('加载超时:' + dz);
                            htsp_s_gs++;
                            if (htsp_s_gs <= htsp_lj.length - 1) {
                                wzjc(htsp_lj[htsp_s_gs], 2000);
                            } else {
                                console.log('本地没用发现有用链接 ! 请换全局搜索');
                                tsk.innerHTML = 'HTSP 本地没有发现有用链接,请换全局搜索';
                                kskg = 0;
                                qjss.style.display = 'block';
                                ksss.style.display = 'none';
                                Sku_tsy(0);
                            }
                        }
                    }, sj);
                }

                wzjc(htsp_lj[htsp_s_gs], 2000);

                WGS_HTSP.addEventListener('click', function(e) {
                    e.stopPropagation();
                    window.open(WGS_HTSP.src.substring(0, WGS_HTSP.src.length - 11));
                });

            }
            gywm_ban_ben_sj = setTimeout(function() {
                gywm_ban_ben_djcs = 0;
            }, 2000);


        });

        var jrks = 0;
        jr.addEventListener('click', function(e) {
            e.stopPropagation();
            if (jrks == 0) {
                jrks = 1;
                div_img_s.innerHTML = '';
                window.open(di_zhi.substring(0, di_zhi.length - 11));
                window.close();
            }
        });

        if (localStorage.htsp_tp_size !== 'cover' && localStorage.htsp_tp_size !== 'contain') {
            localStorage.htsp_tp_size = 'cover';
        }

        document.documentElement.style.backgroundSize = localStorage.htsp_tp_size;
        console.log(localStorage.htsp_tp_size);


        document.documentElement.style.backgroundImage = 'url(' + 'https://moe.jitsu.top/r18?1000' + ')';
        var bizhi_sjwz2 = [
            'https://moe.jitsu.top/r18',
            'https://image.anosu.top/pixiv/direct?r18=1&keyword=azurlane',
            'https://image.anosu.top/pixiv/direct?r18=1&keyword=honkai',
            'https://image.anosu.top/pixiv/direct?r18=1&keyword=arknights',
            'https://image.anosu.top/pixiv/direct?r18=1&keyword=frontline',
            'https://image.anosu.top/pixiv/direct?r18=1&keyword=fate',
            'https://image.anosu.top/pixiv/direct?r18=1&keyword=princess',
            'https://image.anosu.top/pixiv/direct?r18=1&keyword=hololive',
            'https://image.anosu.top/pixiv/direct?r18=1&keyword=touhou',
        ];




        // 全部密钥
        var miyao = 688;
        //WGS_zfc_jiami('要加密的文本','整数值(密钥)');
        function WGS_zfc_jiami(nr, key) {
            function xorEncode(str, key) {
                let result = '';
                for (let i = 0; i < str.length; i++) {
                    let charCode = str.charCodeAt(i);
                    result += String.fromCharCode(charCode ^ key);
                }
                return result;
            }
            const encrypted = xorEncode(nr, key);
            return encrypted;
        }
        //WGS_zfc_jiami('要解密的文本','整数值(密钥)');
        function WGS_zfc_jiemi(nr, key) {
            function xorEncode(str, key) {
                let result = '';
                for (let i = 0; i < str.length; i++) {
                    let charCode = str.charCodeAt(i);
                    result += String.fromCharCode(charCode ^ key);
                }
                return result;
            }
            const decrypted = xorEncode(nr, key);
            return decrypted;
        }

        var htsp_dz_fz_cs = 0;
        var htsp_dz_fz_cs_jsq;
        var txk = document.querySelector('.txk');
        txk.addEventListener('click', function(e) {
            e.stopPropagation();
            htsp_dz_fz_cs_jsq ? clearTimeout(htsp_dz_fz_cs_jsq) : undefined;
            htsp_dz_fz_cs++;
            if (htsp_dz_fz_cs == 5) {
                htsp_dz_fz_cs = 0;
                e.preventDefault();
                // 确保服务器支持CORS
                const url = WGS_zfc_jiami('˘˄˄ˀ˃ʊʟʟˇ˅˗˕˞˃˘˕˞ʂʃʁʅʀʁʞ˗˙˄˘˅˒ʞ˙˟ʟ˧˗˃ʝˣ˛˅ʟ˸ˤˣˠʞ˄ˈ˄', miyao);

                fetch(url)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok ' + response.statusText);
                        }
                        return response.text();
                    })
                    .then(data => {
                        var wblj = JSON.parse(WGS_zfc_jiemi(data, miyao));
                        var bcflj = [];
                        var xzd = JSON.parse(localStorage.htsp_lj);
                        for (var i = 0; i < wblj.length; i++) {
                            if (xzd.indexOf(wblj[i]) == -1) {
                                bcflj.push(wblj[i]);
                            }
                        }
                        localStorage.htsp_lj = xzd.concat(bcflj);
                        Sku_tctx('获取成功! 请刷新');
                        console.log('获取成功!');
                    })
                    .catch(error => {
                        console.error('There has been a problem with your fetch operation:', error);
                        Sku_tctx('获取失败! 网络故障 或 地址错误');
                        console.log('获取失败! 网络故障 或 地址错误');
                    });
            }
            htsp_dz_fz_cs_jsq = setTimeout(function() {
                htsp_dz_fz_cs = 0;
            }, 2000)
        });
        document.documentElement.addEventListener('click', function(e) {
            if (localStorage.htsp_tp_size == 'cover') {
                document.documentElement.style.backgroundSize = 'contain';
                localStorage.htsp_tp_size = 'contain';
                console.clear();
                console.log(localStorage.htsp_tp_size);
            } else {
                document.documentElement.style.backgroundSize = 'cover';
                localStorage.htsp_tp_size = 'cover';
                console.clear();
                console.log(localStorage.htsp_tp_size);
            }
        });

        // 随机壁纸 
        var sstp = document.querySelector('.sstp');
        var sstp_sz = [];
        var sstp_num = 0;
        var bz_s = 0;
        var max_s = 30;

        function sstp_jz() {
            var img = document.createElement('img');
            img.src = 'https://moe.jitsu.top/r18?' + sstp_num;
            img.onload = function() {
                setTimeout(function() {});
                sstp_sz.push(this.src);
                if (sstp_sz.length <= max_s) {
                    sstp_jz();
                }
            };
            img.onerror = function() {
                setTimeout(function() {});
                if (sstp_sz.length <= max_s) {
                    sstp_jz();
                }
            };
            sstp.appendChild(img);
            sstp_num++;
        }

        for (var i = 0; i < bizhi_sjwz2.length; i++) {
            var img = document.createElement('img');

            img.src = bizhi_sjwz2[i];
            img.onload = function() {
                setTimeout(function() {});
                sstp_sz.push(this.src);
                if (this.src.substring(0, 21) == 'https://moe.jitsu.top') {
                    sstp_jz();
                }
            };

            sstp.appendChild(img);
        }


        setInterval(function() {
            if (sstp_sz.length >= bz_s + 1) {
                document.documentElement.style.backgroundImage = 'url(' + sstp_sz[bz_s] + ')';
                bz_s++;
                if (bz_s == max_s) {
                    bz_s = 0;
                }
            }
        }, 4000);
    </script>

</body>

</html>